# 02 추론통계

## 1. 데이터 결측값 처리

통계학을 이용해 모집단의 특성을 추측하는 통계적 추론은 추정(estimation)과 가설검정(testing hypothesis)으로 나누어진다.

- 추정(estimation): 표본을 통해 모집단 특성을 추측하는 과정
- 가설검정(testing hypothesis): 모집단에 대한 추정과 관련해 표본이 가진 정보를 이용해 가설의 옳고 그름 여부를 판단하는 과정

<br>

## 2. 점추정(Point Estimate)

모평균, 모표준편차 같은 모수에 대한 추정치를 이에 대응하는 통계량으로 추정하는 것이다.

### 1) 추정량의 선택기준

#### (1) 불편성(unbiasedness)

**표본통계량의 기댓값이 모수의 실제값과 같을 때** 이 추정량은 불편성을 갖는다.
$$
E(\hat{\theta}) = \theta ~~~~(\hat{\theta}=\text{모수의 추정값}, ~~\theta=\text{모수})
$$
<br>

#### (2) 효율성(Efficency)

추정량 중에서 **분산이 가장 작은 추정량이 가장 효율적이다.**

즉, a, b 두 추정량이 모두 불편성을 갖는다고 하더라도, a가 b보다 분산이 작으면 a 추정량이 더 효울적이라고 말할 수 있다.

**분산이 작다는 것은 편차가 작다는 의미이고, 이는 평균으로 집중된다**라는 해석으로 이어지므로 추정량의 분산이 더 작은것이 더 유효하다고 판단할 수 있다.

- **최소분산불편추정량(MVUE: Minimum Variance Unbiased Estimator)**: 모든 불편추정량 중 가장 작은 분산을 갖는 추정량

<br>

#### (3) 일치성(Consistency)

**표본크기가 증가할수록 추정량이 모수에 근접**하게 된다.

<br>

#### (4) 충분성(Sufficiency)

**추정량이 모수에 대해 가장 많은 정보를 제공할 때** 그 추정량은 충분추정량이 된다.

<br>

### 2) 점추정량(Point Estimator)

**모집단의 특성을 단일값으로 추정한 값**을 점추정량이라고 한다.

대표적 점추정량으로는 표본평균, 표본분산 등이 있고, 중앙값 또한 추정량으로 사용되기도 한다.

점추정의 방법으로는 **적률방법(Moment Method)과 최대우도추정법(Maximum Likelihood Function Method)**이 있다.

<br>

### 3) 적률방법(Moment Method)

#### (1) 적률(Moment)

**모집단의 평균이 표본평균과 일치하는 모수 $\theta$를 찾는 방법**으로, 일반적으로 표본평균값이 모수에 대한 점추정 값이 된다. 

양수 n에 대해 확률변수 $X^n$의 기댓값 $E(X^n)$을 확률변수 X의 **원점에 대한 n차 적률**이라고 한다.
$$
\mu_n = E(X^n)\\\\
E(X^n) = \cases{
\sum X^n f(x) ~~~~~~~~: \text{이산확률변수}\\\\
\int^{\infty}_{-\infty}X^nf(x)dx~ :  \text{연속확률변수}
}\\\\
f(x)\text{는 확률질량함수 또는 확률밀도함수}
$$
<br>

#### (2) 표본평균을 이용한 모수(평균)의 점추정 시 적률에 의한 방법

확률밀도함수가 $f(x; \theta_1, \theta_2, \cdots, \theta_m)$인 모집단으로부터 추출한 n개의 표본을 $X_1, X_2, \cdots, X_{n-1}, X_n$이라 하면, 모수 $\theta_1, \theta_2, \cdots, \theta_m$의 원점에 대한 k차 적률은 다음과 같다.
$$
E(X^n) = \int^\infty_{-\infty}X^k f(x; \theta_1, \theta_2, \cdots, \theta_m)dx
$$
이는 n개의 표본 각각에 대해 계산된 $X^k$의 기댓값이므로 하나의 모수에 대한 추정값은 다음과 같고(표본평균),
$$
M_k = \frac{1}{n}\sum^n_{i=1}x_i^k = \frac{1}{n}(x_1^k + x_2^k + \cdots + x_n^k)
$$
m개의 모수가 있다면 n개의 표본으로부터 m개의 적률을 통해 전체 모수 추정값을 얻게 된다.
$$
E(X) = M_1, E(X^2) = M_2, \cdots, E(X^n) = M_m
$$
<br>

### 4) 편향

편향이란 기대하는 추정량과 실제 모수 값의 차이이다 표본에서 얻어낸 추정량은 모수에 가까울수록, 즉 편향이 작을 수록 좋다.

임의의 추정량이 가진 편향을 $B(\hat{\theta})$라고 하면 $B(\hat{\theta})= E(\hat{\theta}) - \theta$이다.

이에 따라 불편추정량은 $B(\hat{\theta}) = 0$으로 표현될 수 있다.

**표본평균은 불편추정량이나, 표본분산은 불편추정량이 아니다.*

<br>

### 5) 평균제곱오차(MSE: Mean Squared Error)

**평균제곱오차는 점추정량과 모수값의 차이의 제곱에 대한 기댓값**으로 정의하고, 아래와 같이 나타낸다.
$$
MSE(\hat{\theta}) = E[(\hat{\theta} - \theta)^2]
$$
<br>

### 6) 최대우도점추정

#### (1) 우도함수(Likelihood Function)

$X_1, X_2, \cdots, X_{n-1}, X_n$의 결합확률밀도함수 $f(x1, x_2, \cdots, x_n; \theta)$를 모수 $\theta$에 대한 함수로 볼 때, 이를 우도함수로 정의하며 다음과 같이 표시한다.
$$
L(\theta) = L(x_1, x_2, \cdots, x_n; \theta)
$$
이 때 각 확률변수들이 모두 독립이고 같은 확률분포를 따른다면 우도함수는 다음과 같이 표현 가능하다. 
$$
L(\theta) = f(x_1; \theta)f(x_2;\theta) \cdots f(x_n;\theta) =  \prod_i^n f(x_i; \theta)
$$
<br>

#### (2) 최대우도추정(Maximum Likelihood Estimation)

최대우도란 계산된 우도값 중 가장 큰 값을 의미하며, 즉 우도함수를 통해 계산된 **우도값 중 가장 큰 값을 모수 추정량으로 선택하는 방법**이다.

- 확률표본의 우도함수  $L(X_1, X_2, \cdots, X_n \theta)$를 최대로 하는 $\theta$를 $\hat{\theta}$라고 할 때, $\hat{\theta}$를 모수 $\theta$의 최대우도추정량이라 한다.
- 일반적으로 미분을 통해 극댓값을 찾는 방법으로 최대우도추정량을 구한다.
- 계산의 편의성을 위해 우도함수에 로그를 취한 로그우도함수 $lnL(X_1, X_2, \cdots, X_n;\theta)$를 최대로 하는 $\theta$를 구하는 것이 일반적이다.



